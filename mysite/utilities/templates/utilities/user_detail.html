{% extends 'utilities/base.html' %}

<!--Make navigation bar respective blocks active-->
{% block utilities_active %}{% endblock %}
{% block users_active %}{% endblock %}
{% block register_active %}{% endblock %}
{% if user.id == specified_user.id %}
    {% block detail_active %}active{% endblock %}
{% endif %}

{% block body %}
    <div class = "container-fluid">
        <h1>{{ specified_user.username }}</h1><br />

        <!--Last Login and Date Joined-->
        <div class = "row">
            <div class="col-sm-12">
                <p><strong>Last Login:</strong> {{ specified_user.last_login }}</p>
            </div>
        </div>
        <br />
        <div class = "row">
            <div class="col-sm-12">
                <p><strong>Date Joined:</strong> {{ specified_user.date_joined }}</p>
            </div>
        </div>
        <br />
        <!--Manager Details-->
        <div class = "row">
            <div class="col-sm-10">
                <p><strong>Manager:</strong> {{ specified_user.employee.manager }}</p>
            </div>
            <div class="col-sm-2">
                {% if user.employee.manager %}
                    {% if specified_user.employee.manager %}
                        <a href = "{% url 'utilities:set_manager' specified_user.id %}"><button type="button" class="btn btn-danger">Demote</button></a>
                    {% else %}
                        <a href = "{% url 'utilities:set_manager' specified_user.id %}"><button type="button" class="btn btn-success">Promote</button></a>
                    {% endif %}
                {% endif %}
            </div>
        </div>

        <hr id = "section_separator" />
        <!--List of Utilities-->
        <div class = "row">
            <div class="col-sm-10">
                <h3>Accessible Utilities:</h3>
            </div>
            <div class="col-sm-2">
                {% if user.employee.manager %}
                    <a href = "{% url 'utilities:add_utility' specified_user.id %}"><button type="button" class="btn btn-primary">Add Utilities</button></a>
                {% endif %}
            </div>
        </div>

        <br />
        {% for utility in user.employee.utilities.all %}
            <div class = "row">
                <div class="col-sm-10">
                    <div class = "utils"><a href = "{% url 'utilities:utility_detail' utility.id %}">{{ utility.name }}</a></div>
                </div>
                <div class="col-sm-2">
                    <a href = "{{ specified_utility.link }}"><button type="button" class="btn btn-sm btn-primary">Access Utility</button></a>&nbsp;
                    <a href = "{% url 'utilities:remove_utility' specified_user.employee.id utility.id %}"><button type="button" class="btn btn-sm btn-danger">Remove</button></a>
                </div>
            </div>
            <hr />
        {% endfor %}
    </div>
{% endblock %}